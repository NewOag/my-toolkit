# 日志查看器功能说明

## 概述

日志查看器是 My Toolkit 应用的新增功能，允许用户在应用内直接查看和管理日志文件。该功能提供了完整的日志监控和管理能力，包括实时查看、自动刷新、文件导出等功能。

## 功能特性

### 🔍 日志文件查看
- **双日志文件支持**: 同时支持查看 `app.log`（所有日志）和 `my-toolkit.log`（交互事件日志）
- **实时内容显示**: 以代码编辑器样式显示日志内容，支持语法高亮
- **文件信息显示**: 显示文件大小、最后修改时间等元数据

### 🔄 自动刷新
- **手动刷新**: 支持手动刷新单个文件或所有文件
- **自动刷新**: 可开启自动刷新模式，每5秒自动更新日志内容
- **智能更新**: 只更新当前选中的日志文件，提高性能

### 📁 文件管理
- **文件清除**: 一键清除日志文件内容
- **文件导出**: 将日志文件导出到本地
- **错误处理**: 优雅处理文件不存在或读取失败的情况

### 🎨 用户界面
- **现代化设计**: 采用统一的设计系统，与其他工具保持一致
- **响应式布局**: 支持不同屏幕尺寸，包括移动设备
- **状态指示**: 清晰显示加载状态、错误信息等

## 使用方法

### 1. 访问日志查看器
- 在左侧工具栏中点击 📋 图标
- 或使用快捷键切换工具

### 2. 选择日志文件
- 使用下拉菜单选择要查看的日志文件：
  - **应用日志 (app.log)**: 包含所有系统日志
  - **交互日志 (my-toolkit.log)**: 仅包含前后端交互事件

### 3. 查看日志内容
- 日志内容以等宽字体显示，便于阅读
- 支持滚动查看长日志文件
- 不同日志级别使用不同颜色标识

### 4. 管理日志文件
- **刷新**: 点击"刷新"按钮重新加载文件
- **自动刷新**: 勾选"自动刷新"开启定时更新
- **清除**: 点击"清除"按钮清空文件内容
- **导出**: 点击"导出"按钮下载日志文件

## 技术实现

### 前端组件
- **LogViewer.tsx**: 主要的日志查看器组件
- **LogViewer.less**: 样式文件，支持响应式设计
- **EventLogger.ts**: 集成事件日志记录

### 后端命令
- `read_specific_log_file`: 读取指定日志文件
- `clear_log_file`: 清除日志文件内容
- `get_log_file_path`: 获取日志文件路径

### 日志系统集成
- 与现有的双日志系统完全集成
- 支持实时日志查看
- 保持日志格式一致性

## 日志格式

### 应用日志 (app.log)
```
[2024-01-15 10:30:15] [INFO] 应用启动
[2024-01-15 10:30:16] [INFO] 初始化日志系统
[2024-01-15 10:30:17] [WARN] 检测到配置异常
[2024-01-15 10:30:18] [ERROR] 连接数据库失败
[2024-01-15 10:30:19] [DEBUG] 内存使用: 45MB
```

### 交互日志 (my-toolkit.log)
```
[2024-01-15 10:30:15] [FRONTEND] 应用启动事件
[2024-01-15 10:30:20] [FRONTEND] 工具切换: json -> kafka
[2024-01-15 10:30:25] [BACKEND] JSON 格式化响应
[2024-01-15 10:30:30] [FRONTEND] Kafka 连接测试请求
```

## 响应式设计

### 桌面端 (>1024px)
- 完整功能界面
- 并排显示控制面板和日志内容
- 优化的工具栏布局

### 平板端 (768px-1024px)
- 垂直堆叠布局
- 简化的控制面板
- 保持核心功能

### 移动端 (<768px)
- 紧凑的界面设计
- 触摸友好的按钮
- 优化的字体大小

## 性能优化

### 文件读取优化
- 异步文件读取，不阻塞UI
- 错误处理和重试机制
- 文件大小限制和分页支持

### 内存管理
- 及时清理定时器
- 避免内存泄漏
- 优化大文件显示

### 用户体验
- 加载状态指示
- 错误信息提示
- 操作反馈

## 故障排除

### 常见问题

1. **日志文件不存在**
   - 应用首次运行时可能没有日志文件
   - 系统会显示友好的提示信息

2. **文件读取失败**
   - 检查文件权限
   - 确认文件路径正确
   - 查看错误信息

3. **自动刷新不工作**
   - 确认已勾选"自动刷新"选项
   - 检查是否有JavaScript错误
   - 重启应用

### 调试建议

1. **查看控制台日志**
   - 打开浏览器开发者工具
   - 查看Console标签页的错误信息

2. **检查文件权限**
   - 确认应用有读取日志文件的权限
   - 检查文件是否被其他程序占用

3. **重置应用**
   - 清除应用数据
   - 重新启动应用

## 未来计划

### 功能增强
- [ ] 日志搜索和过滤
- [ ] 日志级别筛选
- [ ] 实时日志流
- [ ] 日志分析统计

### 性能优化
- [ ] 虚拟滚动支持
- [ ] 日志压缩存储
- [ ] 增量更新机制

### 用户体验
- [ ] 日志高亮主题
- [ ] 自定义日志格式
- [ ] 日志分享功能

## 总结

日志查看器为 My Toolkit 应用提供了完整的日志管理能力，使用户能够方便地监控应用运行状态、调试问题、分析用户行为。该功能与现有的日志系统完美集成，提供了现代化、响应式的用户界面，支持多种设备和屏幕尺寸。 